<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Risk set • remify</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Open_Sans-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Risk set">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">remify</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.2.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Other Packages</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-other-packages">
<li><a class="external-link dropdown-item" href="https://tilburgnetworkgroup.github.io/remstats/">remstats</a></li>
    <li><a class="external-link dropdown-item" href="https://tilburgnetworkgroup.github.io/remstimate/">remstimate</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/TilburgNetworkGroup/remulate">remulate</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/TilburgNetworkGroup/bremory">bremory</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/TilburgNetworkGroup/remx">remx</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/TilburgNetworkGroup/remverse">remverse</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/TiUNetworkGroup"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/TilburgNetworkGroup/remstimate"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Risk set</h1>
                        <h4 data-toc-skip class="author"></h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/TilburgNetworkGroup/remify/blob/master/vignettes/riskset.Rmd" class="external-link"><code>vignettes/riskset.Rmd</code></a></small>
      <div class="d-none name"><code>riskset.Rmd</code></div>
    </div>

    
    
<hr>
<p><i> This vignette provides a definition of <em>full</em>,
<em>active</em> and <em>manual</em> risk set, it explains how a
<em>manual</em> risk set is declared in the processing function
<code><a href="../reference/remify.html">remify::remify()</a></code>, and it shows how the processed risk set
looks like in the <code>remify</code> object. </i></p>
<hr>
<p>Consider the <code>remify</code> object for the network
<code>randomREHsmall</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TilburgNetworkGroup/remify" class="external-link">remify</a></span><span class="op">)</span> <span class="co"># loading package</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">randomREHsmall</span><span class="op">)</span> <span class="co"># data</span></span>
<span></span>
<span><span class="co"># processing the edgelist </span></span>
<span><span class="va">reh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/remify.html">remify</a></span><span class="op">(</span>edgelist <span class="op">=</span> <span class="va">randomREHsmall</span><span class="op">$</span><span class="va">edgelist</span>,</span>
<span>                          directed <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># events are directed</span></span>
<span>                          ordinal <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># model with waiting times</span></span>
<span>                          model <span class="op">=</span> <span class="st">"tie"</span>, <span class="co"># tie-oriented modeling   </span></span>
<span>                          actors <span class="op">=</span> <span class="va">randomREHsmall</span><span class="op">$</span><span class="va">actors</span>,</span>
<span>                          origin <span class="op">=</span> <span class="va">randomREHsmall</span><span class="op">$</span><span class="va">origin</span>,</span>
<span>                          omit_dyad <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># summary(reh)                                </span></span></code></pre></div>
<hr>
<div class="section level2">
<h2 class="tabset tabset-fade tabset-pills tabcontent" id="section"></h2>
<div class="section level3">
<h3 id="definition-of-risk-set">Definition of risk set<a class="anchor" aria-label="anchor" href="#definition-of-risk-set"></a>
</h3>
<p>A relational event history consists of a time-ordered sequence of
(directed or undirected) interaction. For each event, we know:</p>
<ul>
<li>its <strong>time</strong> of occurrence, either as
timestamp/date/continuous value or just as order</li>
<li>the <strong>actors</strong> that were involved in the realtional
event</li>
<li>the <strong>type</strong> of the event (if measured)</li>
</ul>
<p>For instance, the first five events of the
<code>randomREHsmall</code> sequence are reported as follows</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">randomREHsmall</span><span class="op">$</span><span class="va">edgelist</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##                  time  actor1 actor2</span></span>
<span><span class="co">## 1 2020-03-05 15:36:37  Colton  Kayla</span></span>
<span><span class="co">## 2 2020-03-05 18:34:11    Lexy Colton</span></span>
<span><span class="co">## 3 2020-03-05 19:49:37  Colton  Kayla</span></span>
<span><span class="co">## 4 2020-03-05 20:38:23  Colton  Kayla</span></span>
<span><span class="co">## 5 2020-03-06 05:54:12 Richard Colton</span></span></code></pre>
<p>where <code>time</code>, <code>actor1</code>, <code>actor2</code>
describe each observed event in the sequence (Note that in this example
the <code>type</code> of events is not annotated).</p>
<p>When modeling a relational event sequence, we have to define per each
time point a risk set, which consists of the set of those relational
events (dyads) that at a specific time point were likely to be observed
(this set also contains the event that is actually observed at a
specific time point). The definition of the risk set is an important
building block of the likelihood function for both tie-oriented and
actor-oriented modeling framework. In the sections of this vignette, we
discuss three possible definitions of the risk set: <em>full</em>,
<em>active</em> and <em>manual</em> risk set. These three types of risk
set can be processed with <code><a href="../reference/remify.html">remify::remify()</a></code> by specifying
the risk set type to the input argument <code>riskset</code>.</p>
<hr>
<div class="section level4">
<h4 id="the-full-risk-set">The <em>full</em> risk set<a class="anchor" aria-label="anchor" href="#the-full-risk-set"></a>
</h4>
<p>The most common definition of the risk set assumes that all the
possible dyads are likely to occur over the whole observation period. We
refer to this definition as <em>full</em> risk set. If the network has
<em>N</em> actors and it consists of directed events that can assume a
number of <em>C</em> possible event types, then the risk set will be
characterized by all the possible directed dyads among <em>N</em>
actors, which are <em>D = N(N-1)C</em>, or <em>D = N(N-1)C/2</em> in the
case of undirected dyads. For instance, in the random network
(<code>randomREHsmall</code>) dyads are directed, actors are <em>N =
5</em> and event types are <em>C = 1</em>, therefore we expect the
dimension of the risk set to be <em>D = 5 * 4 * 1 = 20</em>. The first
five dyads in the <em>full</em> risk set will be</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># method getDyad(), see more in ?remify::getDyad</span></span>
<span><span class="fu"><a href="../reference/getDyad.html">getDyad</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">reh</span>, dyadID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">##   dyadID    actor1    actor2</span></span>
<span><span class="co">## 1      1    Colton Francesca</span></span>
<span><span class="co">## 2      2    Colton     Kayla</span></span>
<span><span class="co">## 3      3    Colton      Lexy</span></span>
<span><span class="co">## 4      4    Colton   Richard</span></span>
<span><span class="co">## 5      5 Francesca    Colton</span></span></code></pre>
<p>The ID of the dyads (<code>dyadID</code>) corresponds to the order of
the dyads used by the functions in
`<code>and it is processed by the function</code>remify::remify()`. The
ID of the dyads is defined by a two-steps approach:</p>
<ol style="list-style-type: decimal">
<li>Actors’ and types’ names are first sorted according to their
<div class="hovertip">
alphanumeric<span class="hovertiptext">
<p>
The alphanumeric order follows first the order of numbers from 0 to 9,
then the alphabetical order of the letters.
</p>
<p>
For instance, given the vector of names
<code>c("user22","0usr","1user","1deer")</code>, its alphanumeric order
will be <code>c("0usr","1deer","1user","user22)</code>
</p>
<i></i></span>
</div>
order, that for the actors in the random network will be,</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sorted vector of actors' names</span></span>
<span><span class="va">sorted_actors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">randomREHsmall</span><span class="op">$</span><span class="va">actors</span><span class="op">)</span></span>
<span><span class="va">sorted_actors</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Colton"    "Francesca" "Kayla"     "Lexy"      "Richard"</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># number of actors in the network</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">randomREHsmall</span><span class="op">$</span><span class="va">actors</span><span class="op">)</span></span></code></pre></div>
<p>and for the event type will be</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># no event type, we set it to an empty string</span></span>
<span><span class="va">sorted_types</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">" "</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># C = 1 for 'randomREHsmall'</span></span>
<span><span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sorted_types</span><span class="op">)</span> </span></code></pre></div>
<p>In this phase, the processing function <code><a href="../reference/remify.html">remify::remify()</a></code>
will also assign numeric IDs to both actors and event types</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># IDs of actors will consist of an integer number from 1 to N</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sorted_actors</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">N</span></span>
<span><span class="va">sorted_actors</span></span></code></pre></div>
<pre><code><span><span class="co">##           1           2           3           4           5 </span></span>
<span><span class="co">##    "Colton" "Francesca"     "Kayla"      "Lexy"   "Richard"</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># IDs of types will be an integer number from 1 to C</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sorted_types</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">C</span> <span class="co"># in this case is one (artificial) event type</span></span>
<span><span class="va">sorted_types</span></span></code></pre></div>
<pre><code><span><span class="co">##   1 </span></span>
<span><span class="co">## " "</span></span></code></pre>
<ol start="2" style="list-style-type: decimal">
<li>dyads are defined by the triple <code>c(actor1,actor2,type)</code>
that is found by looping first on <code>actor2</code>, then
<code>actor1</code>, and finally <code>type</code>. An example of the
loops is shown below</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># initializing matrix object where to store the dyads as [actor1,actor2,type]</span></span>
<span><span class="va">dyad_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">N</span><span class="op">*</span><span class="op">(</span><span class="va">N</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">C</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dyad_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"actor1"</span>,<span class="st">"actor2"</span>,<span class="st">"type"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dyad_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">N</span><span class="op">*</span><span class="op">(</span><span class="va">N</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">C</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># initializing position index</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fl">1</span> </span>
<span></span>
<span><span class="co"># start three loops</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">type</span> <span class="kw">in</span> <span class="va">sorted_types</span><span class="op">)</span><span class="op">{</span> <span class="co"># loop over event types, </span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">actor1</span> <span class="kw">in</span> <span class="va">sorted_actors</span><span class="op">)</span><span class="op">{</span> <span class="co"># loop over actor1</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">actor2</span> <span class="kw">in</span> <span class="va">sorted_actors</span><span class="op">)</span><span class="op">{</span> <span class="co"># loop over actor2</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="va">actor1</span><span class="op">!=</span><span class="va">actor2</span><span class="op">)</span><span class="op">{</span> <span class="co"># avoid self-loops</span></span>
<span>        <span class="va">dyad_mat</span><span class="op">[</span><span class="va">d</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">actor1</span>,<span class="va">actor2</span>,<span class="va">type</span><span class="op">)</span></span>
<span>        <span class="va">d</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span> <span class="co"># same result as showed above by using the method `getDyad()`</span></span>
<span><span class="va">dyad_mat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##   actor1      actor2      type</span></span>
<span><span class="co">## 1 "Colton"    "Francesca" " " </span></span>
<span><span class="co">## 2 "Colton"    "Kayla"     " " </span></span>
<span><span class="co">## 3 "Colton"    "Lexy"      " " </span></span>
<span><span class="co">## 4 "Colton"    "Richard"   " " </span></span>
<span><span class="co">## 5 "Francesca" "Colton"    " "</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># checking the size of the _full_ risk set that is 20</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">dyad_mat</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> </span></code></pre></div>
<pre><code><span><span class="co">## [1] 20</span></span></code></pre>
<p>The matrix <code>dyad_mat</code> above describes the <em>full</em>
risk set and the row indices correspond to the ID of each dyad
(<code>dyadID</code>). For instance, the <code>dyadID</code> is useful
in the case of tie-oriented modeling, where the <code>remify</code>
object will contain the attribute named <code>"dyad"</code>, which
describes the time-ordered sequence of ID’s as to the observed
dyads.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># accessing the first values of the attribute "dyad" </span></span>
<span><span class="co"># (attribute available only for tie-oriented modeling)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">reh</span>,<span class="st">"dyad"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  2 13  2  2 17  2</span></span></code></pre>
<hr>
</div>
<div class="section level4">
<h4 id="visualizing-the-risk-set">Visualizing the risk set<a class="anchor" aria-label="anchor" href="#visualizing-the-risk-set"></a>
</h4>
<p>A possible way for visualizing the risk set composition at each time
point consists in plotting a grid with actors’ names on both axes:
referring to the <strong>senders</strong> (on the
<strong>y-axis</strong>) and to the <strong>receivers</strong> (on the
<strong>x-axis</strong>).</p>
<center>
<img src="riskset_files/figure-html/unnamed-chunk-9-1.png" width="700">
</center>
<p>Cosidering the first four time points of <code>randomREHsmall</code>,
we observe: the (directed) dyad <em>(Colton,Kayla)</em> at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>1</mn></msub><annotation encoding="application/x-tex">t_1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>3</mn></msub><annotation encoding="application/x-tex">t_3</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>4</mn></msub><annotation encoding="application/x-tex">t_4</annotation></semantics></math>
and the (directed) dyad <em>(Lexy,Colton)</em> at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>2</mn></msub><annotation encoding="application/x-tex">t_2</annotation></semantics></math>.
The cell corresponding to the relational event occurred at each time
point is colored in green. The rest of the cells are colored in gray,
indicating those dyadic events that could have occurred and they are
part of the risk set. Cells in white, indicate those events that could
not occur (in this case the self-loops, like <em>(Colton,Colton)</em>,
where sender and receiver are the same actor).</p>
<p>A <em>full</em> risk set in undirected networks will assume a
particular grid visualization. The dyads at risk will be on the lower
triangular grid, because the actor names <code>c(actor1,actor2)</code>
describing the dyad in the input edgelist are sorted according to their
alphanumeric order before being processed. For instance, the event at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>2</mn></msub><annotation encoding="application/x-tex">t_2</annotation></semantics></math><code>c("Lexy","Colton")</code>, will be rearranged as
<code>c("Colton","Lexy")</code>, and the risk set will change as follows
in the picture below.</p>
<center>
<img src="riskset_files/figure-html/unnamed-chunk-10-1.png" width="50%">
</center>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="the-active-and-manual-risk-set">The <em>active</em> and <em>manual</em> risk set<a class="anchor" aria-label="anchor" href="#the-active-and-manual-risk-set"></a>
</h3>
<p>A <em>full</em> risk set is assumed to have a constant structure
throughout the whole event history. All the possible dyads are assumed
to be always at risk regardless any consideration about: (i) the
possibility of one or more actors to still be able to interact with the
other actors during the observation period, (ii) the possiblity of some
event types to actually occur.</p>
<p>From this observation, the concept of a risk set structure that
changes over time may accomodate certain relational event histories in
which, actors, dyads or event types may not be observed within
prespecified time windows. Two alternative definitions of the risk set
can be declared with <code><a href="../reference/remify.html">remify::remify()</a></code>:</p>
<ul>
<li>the <em>active</em> risk set, which reduces its size to only the
dyadic events that are observed across the event history and it mantains
the same (modified) structure over time</li>
<li>the <em>manual</em> riskset, which allows the user to specify a more
flexible risk set with a time-varying structure, in which actor, dyads
or event types can be excluded at specific time intervals of the event
history.</li>
</ul>
<hr>
<div class="section level4">
<h4 id="the-active-risk-set">The <em>active</em> risk set<a class="anchor" aria-label="anchor" href="#the-active-risk-set"></a>
</h4>
<p>There exist relational event networks that have a large number of
actors and the number of observed dyads is by far lower than the
potential number of dyads (i.e. the size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>
of the <em>full</em> risk set).</p>
<p>A measure of global density can be calculated over the whole event
sequence as the ratio
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mtext mathvariant="normal">obs</mtext></msub><mi>/</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">D_{\text{obs}}/D</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mtext mathvariant="normal">obs</mtext></msub><annotation encoding="application/x-tex">D_{\text{obs}}</annotation></semantics></math>
is the number of observed dyadic events and it can vary between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>.
When a very low portion of dyads takes action in the network, we can
think of restricting the risk set only to such observed dyads. This risk
set reduction leads to the <em>active</em> risk set, which mantains the
same structure over time but is restricted to the dyads that were
observed at least one time in the event history. This type of risk set
can be declared by specifying <code>riskset = "active"</code> in
<code><a href="../reference/remify.html">remify::remify()</a></code></p>
<p>The use of the active risk set can significantly decrease the
computational time of both the calculation of statistics and the
estimation of model parameters. However, the reduction of the risk set
to the set of <em>active</em> (observed) dyads causes the exclusion of
dyadic events that perhaps should be still included in the risk set. It
is always good practice to explore the set of <em>active</em> dyads and
take the due considerations given the type of data at hand, for
instance: (i) expecting potential biases coming from the definition of
an <em>active</em> risk set, (ii) considering to define a modification
of the <em>active</em> risk set that avoids the exclusion of a set of
additional actors/dyads/event types from the risk set even if they were
not observed in the event history.</p>
<hr>
</div>
<div class="section level4">
<h4 id="the-manual-risk-set">The <em>manual</em> risk set<a class="anchor" aria-label="anchor" href="#the-manual-risk-set"></a>
</h4>
<p>There are circumstances in which one or more actors cannot take part
in a relational event or an event type cannot be observed. This can
happen either for a time window that can assume one of the following
definitions:</p>
<ul>
<li>the time window is embedded in the event history, e.g., some actors
temporarily drop the network</li>
<li>the time window starts from a time point after the start of the
event history and stops with the end of the history, e.g., when actors
leave the network without poissibility of return</li>
<li>the time window starts with beginning of the event history and stops
before the end of the study, e.g., actors that join the network after
the beginning of the event history and could only interact after they
join.</li>
</ul>
<p>To give a grasp of a few possible real scenarios in which
actors/dyads/event types may be excluded from the risk set, we introduce
three examples:</p>
<ul>
<li><p><strong>Example 1:</strong> when the relational event network is
about in-person interactions (e.g., at the university or at school) and
it is measured over days (or even weeks or months). One or more actors
may not be present during one or more days, therefore we want to exclude
such actors from the risk set for the specific time spans in which they
could not interact. Furthermore, one or more actors may join (leave) the
network after (before) the beginning (end) of the event history and this
can also define specific restrictions on the risk set for such
actors.</p></li>
<li><p><strong>Example 2:</strong> when relational events are observed
at a conference where multiple sessions or workshops can occur at the
same time. In this case, the set of dyads at risk reduces to smaller
different risk sets, each one based on the groups of actors
participating at a specific session or workshop (constraints on the risk
set here apply as a response to spatial constraints during a sesison or
a workshop).</p></li>
<li><p><strong>Example 3:</strong> when the relational events are
digital interactions and one or more actors cannot interact one another
because they do not appear in each other’s friends list (which may be a
requirement in order to be able to interact).</p></li>
</ul>
<p>In such scenarios and in many others, a <em>full</em> risk set would
account for relational events that are not feasible and this may even
lead to biased estimates of the model parameters. On contrary, it is
possible to account for changes of the risk set over time by defining a
<em>manual</em> risk set.</p>
<p>A <em>manual</em> risk set consists of a time-based definition of the
ensemble of dyads at risk where the user specifies which dyads to remove
from the <em>full</em> risk set at a specific time interval of the
study. This can be done via the <code>omit_dyad</code> argument of the
function <code><a href="../reference/remify.html">remify::remify()</a></code>. The user can define multiple
modifications of the <em>full</em> risk set occurring at different, or
even overlapping, time windows. In each modification, the user specifies
the set of actors, or dyads, or event types to be omitted.</p>
<p>Consider the first four time points of the small random network and
assume this time that actors <code>"Richard"</code> and
<code>"Francesca"</code> didn’t join the study until the second day of
the study. This means that the risk set for at least the first four time
points will have the following composition,</p>
<center>
<img src="riskset_files/figure-html/unnamed-chunk-11-1.png" width="700">
</center>
<p>where the tiles defining the dyads where <code>"Richard"</code> and
<code>"Francesca"</code> are either the sender (actor1) or receiver
(actor2) are excluded from the risk set (the tiles are now in white).
The risk set is now made of only those dyads in which
<code>"Colton"</code>, <code>"Kayla"</code> and <code>"Lexy"</code>are
either the sender or the receiver of a relational event (tiles in
gray).</p>
<p>Finally, a <em>manual</em> risk set can be defined also for
undirected networks and the grid visualization will focus on the lower
triangular grid, because the actor names <code>c(actor1,actor2)</code>
describing the dyad in the input edgelist are sorted according to their
alphanumeric order by the processing. For instance, the event at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>2</mn></msub><annotation encoding="application/x-tex">t_2</annotation></semantics></math><code>c("Lexy","Colton")</code>, will be rearranged as
<code>c("Colton","Lexy")</code>, thus the risk set will change as
below.</p>
<center>
<img src="riskset_files/figure-html/unnamed-chunk-12-1.png" width="50%">
</center>
<div class="section level5">
<h5 id="specifying-a-manual-risk-set-the-omit_dyad-argument">
<strong>Specifying a <em>manual</em> risk set: the
<code>omit_dyad</code> argument</strong><a class="anchor" aria-label="anchor" href="#specifying-a-manual-risk-set-the-omit_dyad-argument"></a>
</h5>
<p>The input argument <code>omit_dyad</code> is required when the
argument <code>riskset = "manual"</code>. With this argument, the user
describes the time windows and the actor/dyads/event types to exclude
from them. The object to supply via the argumen <code>omit_dyad</code>
consists of a list of modifications. Each list refers to one risk set
modification and must be a list of two objects: a
<code>data.frame</code> called <code>dyad</code>, where dyads to be
removed are specified by row in the format
<code>actor1, actor2, type</code>, and a vector called <code>time</code>
which describes the first and last time point of the time window where
to apply the modification.</p>
</div>
<div class="section level5">
<h5 id="example-on-five-risk-set-modifications">
<em>Example on five risk set modifications</em><a class="anchor" aria-label="anchor" href="#example-on-five-risk-set-modifications"></a>
</h5>
<p>Consider the <code>randomREH</code> data.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">randomREH</span><span class="op">)</span></span></code></pre></div>
<p>For instance, we want to modify (reduce) the risk set according to
five changes that apply on different time intervals:</p>
<ol style="list-style-type: decimal">
<li>an event type <code>conflict</code> that was no more feasible since
a specific time point until the end of the observation period.</li>
</ol>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">randomREH</span><span class="op">$</span><span class="va">omit_dyad</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time</span> <span class="co"># start and stop time point defining the time window of interest</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "2020-05-07 20:42:38 UTC" "2020-05-23 21:46:41 UTC"</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">randomREH</span><span class="op">$</span><span class="va">omit_dyad</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">dyad</span> <span class="co"># dyads to be removed from the time points defined by the interval in `time`</span></span></code></pre></div>
<pre><code><span><span class="co">##   actor1 actor2     type</span></span>
<span><span class="co">## 1     NA     NA conflict</span></span></code></pre>
<ol start="2" style="list-style-type: decimal">
<li>two actors <code>Michaela</code> and <code>Zackary</code> that
couldn’t interact with anybody else after a specific time point until
the last observed time point.</li>
</ol>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">randomREH</span><span class="op">$</span><span class="va">omit_dyad</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "2020-05-19 23:30:09 UTC" "2020-05-23 21:46:41 UTC"</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">randomREH</span><span class="op">$</span><span class="va">omit_dyad</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">dyad</span></span></code></pre></div>
<pre><code><span><span class="co">##     actor1   actor2 type</span></span>
<span><span class="co">## 1 Michaela     &lt;NA&gt;   NA</span></span>
<span><span class="co">## 2     &lt;NA&gt; Michaela   NA</span></span>
<span><span class="co">## 3  Zackary     &lt;NA&gt;   NA</span></span>
<span><span class="co">## 4     &lt;NA&gt;  Zackary   NA</span></span></code></pre>
<p>The object <code>dyad</code> will give instructions such that the
function will remove from the risk set at the indicated time windows all
the events where: (1) type is <code>conflict</code>, (2)
<code>Michaela</code> and `<code>Zackary</code> are senders or
receivers.</p>
<p>In this example we also add three more modifications of the risk set
that are not present in the object <code>randomREH$omit_dyad</code> but
that allow to explain how the input <code>omit_dyad</code> works, and
also how the processed risk set object will look like (in the next
section):</p>
<ol start="3" style="list-style-type: decimal">
<li>actors <code>Maya</code>, <code>Alexander</code>,
<code>Richard</code> and <code>Charles</code> joined the network after
the start of the event history.</li>
</ol>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">randomREH</span><span class="op">$</span><span class="va">omit_dyad</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time</span> </span></code></pre></div>
<pre><code><span><span class="co">## [1] NA                        "2020-04-02 03:31:13 UTC"</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">randomREH</span><span class="op">$</span><span class="va">omit_dyad</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">dyad</span> </span></code></pre></div>
<pre><code><span><span class="co">##      actor1    actor2 type</span></span>
<span><span class="co">## 1      Maya      &lt;NA&gt;   NA</span></span>
<span><span class="co">## 2 Alexander      &lt;NA&gt;   NA</span></span>
<span><span class="co">## 3   Richard      &lt;NA&gt;   NA</span></span>
<span><span class="co">## 4   Charles      &lt;NA&gt;   NA</span></span>
<span><span class="co">## 5      &lt;NA&gt;      Maya   NA</span></span>
<span><span class="co">## 6      &lt;NA&gt; Alexander   NA</span></span>
<span><span class="co">## 7      &lt;NA&gt;   Richard   NA</span></span>
<span><span class="co">## 8      &lt;NA&gt;   Charles   NA</span></span></code></pre>
<ol start="4" style="list-style-type: decimal">
<li>actor <code>Breanna</code> left the network during a long time
interval (about 2 months) embedded in the event history.</li>
</ol>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">randomREH</span><span class="op">$</span><span class="va">omit_dyad</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "2020-03-27 09:55:56 UTC" "2020-05-13 10:17:57 UTC"</span></span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">randomREH</span><span class="op">$</span><span class="va">omit_dyad</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">dyad</span></span></code></pre></div>
<pre><code><span><span class="co">##    actor1  actor2 type</span></span>
<span><span class="co">## 1 Breanna    &lt;NA&gt;   NA</span></span>
<span><span class="co">## 2    &lt;NA&gt; Breanna   NA</span></span></code></pre>
<ol start="5" style="list-style-type: decimal">
<li>actor <code>Megan</code> left the network for a few days.</li>
</ol>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">randomREH</span><span class="op">$</span><span class="va">omit_dyad</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "2020-04-30 07:44:08 UTC" "2020-05-04 01:20:53 UTC"</span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">randomREH</span><span class="op">$</span><span class="va">omit_dyad</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">dyad</span></span></code></pre></div>
<pre><code><span><span class="co">##   actor1 actor2 type</span></span>
<span><span class="co">## 1  Megan   &lt;NA&gt;   NA</span></span>
<span><span class="co">## 2   &lt;NA&gt;  Megan   NA</span></span></code></pre>
</div>
<div class="section level5">
<h5 id="using-na-values-to-remove-sets-of-actorsdyadsevent-types">
<em>Using <code>NA</code> values to remove sets of
actors/dyads/event types</em><a class="anchor" aria-label="anchor" href="#using-na-values-to-remove-sets-of-actorsdyadsevent-types"></a>
</h5>
<p>The <code>&lt;NA&gt;</code> values mean that all the actors/event
types are considered in that field. Indeed, in the change 1. where we
needed to remove all the events where <code>conflict</code> was the
type, we did it by leaving both <code>actor1</code> and
<code>actor2</code> unspecified <code>&lt;NA&gt;</code>. Therefore,
every time one of the fields among
(<code>actor1</code>,<code>actor2</code>,<code>type</code>) is left
undefined, the reduction applies to all the possible values of that
field. Another example are the risk set chages declared in 4. and 5.,
where we wanted to exclude all the dyads in which <code>Breanna</code>
and <code>Megan</code> are either the sender or the receiver of a
relational event. Therefore, we defined a <code>data.frame</code> named
<code>"dyad"</code> with two rows: one row in which
<code>Breanna</code>(<code>Megan</code>) appeared as the sender, and a
second row in which <code>Breanna</code> (<code>Megan</code>) appeared
as the receiver. We left the other fields set to <code>NA</code>,
meaning that (by row) all the possible event types and actors are to be
considered.</p>
</div>
<div class="section level5">
<h5 id="visualizing-the-risk-set-modifications-declared-with-omit_dyad-before-the-processing">
<strong>Visualizing the risk set modifications declared with
<code>omit_dyad</code> (<em>before the processing</em>) </strong><a class="anchor" aria-label="anchor" href="#visualizing-the-risk-set-modifications-declared-with-omit_dyad-before-the-processing"></a>
</h5>
<p>We can visualize the risk set modifications as they are declared via
the <code>omit_dyad</code> argument in a plot where the x-axis
represents the time and the y-axis describes the five risk set
modifications presented above.</p>
<p><img src="riskset_files/figure-html/unnamed-chunk-27-1.png" width="50%"></p>
<hr>
</div>
</div>
</div>
<div class="section level3">
<h3 id="the-processed-risk-set">The processed risk set<a class="anchor" aria-label="anchor" href="#the-processed-risk-set"></a>
</h3>
<p>The function <code><a href="../reference/remify.html">remify::remify()</a></code> processes the list of
modifications supplied to <code>omit_dyad</code> (only when
<code>riskset = "manual"</code>). The aim is to elaborate the risk set
modifications by accounting for the possible partial/complete
overlapping of time windows. A way to understand whatthe processing does
is to consider the plot of the input modifications and show the plot of
the final processing.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">edgelist_reh</span> <span class="op">&lt;-</span> <span class="fu">remify</span><span class="fu">::</span><span class="fu"><a href="../reference/remify.html">remify</a></span><span class="op">(</span>edgelist <span class="op">=</span> <span class="va">randomREH</span><span class="op">$</span><span class="va">edgelist</span>,</span>
<span>                    directed <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># events are directed</span></span>
<span>                    ordinal <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># model with waiting times</span></span>
<span>                    model <span class="op">=</span> <span class="st">"tie"</span>, <span class="co"># tie-oriented modeling</span></span>
<span>                    actors <span class="op">=</span> <span class="va">randomREH</span><span class="op">$</span><span class="va">actors</span>,</span>
<span>                    types <span class="op">=</span> <span class="va">randomREH</span><span class="op">$</span><span class="va">types</span>, </span>
<span>                    riskset <span class="op">=</span> <span class="st">"manual"</span>,</span>
<span>                    origin <span class="op">=</span> <span class="va">randomREH</span><span class="op">$</span><span class="va">origin</span>,</span>
<span>                    omit_dyad <span class="op">=</span> <span class="va">randomREH</span><span class="op">$</span><span class="va">omit_dyad</span><span class="op">)</span></span></code></pre></div>
<center>
<img src="riskset_files/figure-html/unnamed-chunk-29-1.png" width="50%">
</center>
<p>The processing function understands the partial/complete overlapping
of the time windows and defines new time intervals in which one or more
risk set changes are observed. In the plot below, the vertical
boundaries (dashed red lines) indicate the time intervals. Such time
bounds are used from the processing function to intersect the time
windows decalred in <code>omit_dyad</code> and define new time
intervals, where the changes of the risk set are processed according to
the new time windows. If the user supplies time windows that are not
overlapping, then the processed risk set will have the same structure of
the input.</p>
<center>
<img src="riskset_files/figure-html/unnamed-chunk-31-1.png" width="50%">
</center>
<p>After the processing of a relational event history, the
<code>remify</code> object will contain a list called
<code>omit_dyad</code> where two objects (<code>time</code> and
<code>riskset</code>) will describe the processed risk set
modifications. As a result of the processing of the five risk set
modifications, the risk set is describe now by eight risk set
modifications. This is due to the partial/total overlapping of two or
more time intervals. For instance, the second modification of the
processed risk set (figure below) will contain the combination of the
third and the fourth modification declared in the input
<code>omit_dyad</code> (figure above).</p>
<center>
<img src="riskset_files/figure-html/unnamed-chunk-32-1.png" width="50%">
</center>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Giuseppe Arena.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
